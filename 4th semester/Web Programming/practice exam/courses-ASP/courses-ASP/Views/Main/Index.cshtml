@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}

<div class="text-center">
    <input placeholder="Enter courseName" id="courseName"/><br/><br/>
    <button id='view' type="submit">View participants</button><br/>
    <div id="participantsData"></div><br/>
    <br/><br/>

    <input placeholder="Enter studentName" id="studentName"/><br/><br/>
    <button id='participatesIn' type="submit">Participates in</button><br/>
    <div id="coursesData"></div><br/>
    <br/>
   
    <div id="profCourseData"></div><br/>
    <input placeholder="Enter studentName" id="studentNameGrade"/><br/>
    <input placeholder="Enter studentGrade" id="studentGrade"/><br/>
    <button id="addGrade" type="submit">Add grade</button><br/>
    <div id="addGradeMessage"></div>
</div>




<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script defer>
    $(document).ready(function(){
           
            $("#view").click(function() {
                //console.log("button clicked with val: ", $("#courseName").val());
                if ($("#courseName").val() == "") {
                    alert("field must be completed")
                    return;
                }
                  $.get("/Main/GetParticipants", {courseName : $("#courseName").val()},
                    function(data) {
                        //console.log("got here with data: ", data)
                       if(data)
                            $("#participantsData").html(data);
                          else
                            $('#participantsData').html("No participant for the given course name");
                        
                });
                    
            });

            function buildTable(data) {
                let code_string="<div class='text-center'><table>";
                for (let row in data) {
                    console.log("row: ", data[row]);
                    code_string += "<tr><td>" + data[row] + "</td></tr>";
                }
                code_string+="</table></div>";
                $("#coursesData").html(code_string);
            }

            $("#participatesIn").click(function() {
                if ($("#studentName").val() == "") {
                    alert("field must be completed")
                    return;
                }
                console.log("button clicked with val: ", $("#studentName").val());
                $.get("/Main/getCourses", { student: $('#studentName').val() },
                    function(data) {
                        if(data)
                            buildTable(data);
                              else
                                $('#coursesData').html("No participant for the given course name");

                    })
            })

            $(document).ready(function() {
                $.get("/Main/getProfCourses", function(data) {
                    console.log(data)
                    selectProfCourse(data)
                })
            })

            function selectProfCourse(data) {
                let codeString = "<select id='select'><option selected disabled>choose course</option>";
                for (let course in data) {
                    codeString += "<option>" + data[course] + "</option>"
                }
                codeString += "</select>"
                $("#profCourseData").html(codeString)
            }

        $("#addGrade").click(function() {
            if ($("#select").val() == "" || $("#studentNameGrade").val() == "" ||$("#studentGrade").val() == "") {
                    alert("all fields must be completed")
                    return;
                }
            console.log("button clicked with val: ", $("#select").val(), " ", $("#studentNameGrade").val(), " ", $("#studentGrade").val());
            $.get("/Main/addGrade", {courseName: $("#select").val(), studentName: $("#studentNameGrade").val(), grade: $("#studentGrade").val()},
                function(data) {
                    if (data) {
                        $('#addGradeMessage').html("Grade added");
                    } else {
                        $('#addGradeMessage').html("error");
                    }
                })
        })
         });
</script>